```sql
select version()

select * from gp_segment_configuration

select * from pg_filespace_entry
```



## 查询每个segment的物理路径

 

select * from pg_filespace_entry

 

## 查询每个segment的物理机ip和port

 

select * from gp_segment_configuration

 

## 查询每个表的占用空间

 

select pg_size_pretty(pg_relation_size('schema.tname'));



## 分布键

 

create table (

)

distributed by (id)

 



 

## 列存储

 

create table (

)

with

(

​    appendonly=true,

​    orientation=column,

​    compresslevel=5

)

distributed by (id);





# 性能监控

**gpcheckperf**检查系统性能

**gpstate**程序可以帮助我们识别segment状态。







The gp_size_* family of views can be used to determine the disk space usage for a distributed Greenplum
Database, schema, table, or index. The following views calculate the total size of an object across all
primary segments (mirrors are not included in the size calculations).

• gp_size_of_all_table_indexes

• gp_size_of_database

• gp_size_of_index

• gp_size_of_partition_and_indexes_disk

• gp_size_of_schema_disk

• gp_size_of_table_and_indexes_disk

• gp_size_of_table_and_indexes_licensing

• gp_size_of_table_disk

• gp_size_of_table_uncompressed

• gp_disk_free